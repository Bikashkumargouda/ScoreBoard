<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Admin Control Panel</title>
  <script src="/socket.io/socket.io.js"></script>

  <style>
    body {
      font-family: "Segoe UI";
      background: #f8f9fa;
      padding: 30px;
    }

    h1 {
      text-align: center;
      color: #333;
    }

    table {
      margin: 20px auto;
      border-collapse: collapse;
      width: 70%;
    }

    th,
    td {
      padding: 12px;
      text-align: center;
    }

    input {
      width: 80px;
      text-align: center;
    }

    button {
      padding: 10px 16px;
      background: #0077b6;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background: #005f89;
    }

    img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
    }

    .buttons {
      text-align: center;
      margin-top: 20px;
    }

    .reset {
      background: red;
    }
  </style>
</head>

<body>

  <h1>ðŸŽ® Admin Control Panel</h1>

  <table id="table"></table>

  <div class="buttons">
    <button onclick="updateAll()">Update All Scores</button>
    <button class="reset" onclick="resetAll()">Reset All Scores</button>
  </div>

  <script>
    const socket = io();
    let playersData = [];

    function renderTable(players) {
      playersData = players;

      document.getElementById("table").innerHTML =
        `
        <tr>
          <th>Avatar</th>
          <th>Player</th>
          <th>Score</th>
        </tr>
        ` +
        players.map(p => `
          <tr>
            <td><img src="${p.avatar}"></td>
            <td>${p.name}</td>
            <td><input type="number" id="score-${p.name}" value="${p.score}"></td>
          </tr>
        `).join("");
    }

    function updateAll() {
      const updated = playersData.map(p => ({
        name: p.name,
        score: parseInt(document.getElementById(`score-${p.name}`).value)
      }));
      socket.emit("updateAllScores", updated);
    }

    function resetAll() {
      socket.emit("resetScores");
    }

    socket.on("scoreUpdate", (players) => renderTable(players));
  </script>

</body>

</html>